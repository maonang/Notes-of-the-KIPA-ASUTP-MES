# Парсинг мнемосхем HMIWeb от Honeywell

## Описание
Предназначена для автоматического анализа мнемосхем Honeywell HMIWeb (формат *.htm) и связанных с ними графических файлов SHAPE (*.sha).  
Рекурсивно ищет мнемосхемы, извлекает все элементы интерфейса, связанные параметры, ссылки на графические объекты и формирует полный структурированный отчет в формате Excel (*.xlsx).

Решение подходит для диагностики, документирования, аудита и обратного проектирования сложных HMI систем (операторских интерфейсов SCADA Honeywell Experion).

## Назначение
Программа выполняет:

- Анализ мнемосхем Honeywell HMIWeb
- Извлечение всех HMI-элементов (hsc.shape.1)
- Разбор атрибутов `parameters`, `hdxproperties`, `linktype`
- Обнаружение всех связанных файлов SHAPE
- Разбор SHA-файлов (title, parameters, scripts, metadata)
- Формирование детализированного отчета в Excel
- Автоматическую обработку мнемосхем в больших проектах

# Возможности

## Поиск и анализ файлов
- Рекурсивный поиск всех файлов `*.htm`
- Автоматическое определение папок `*_files`
- Поиск всех связанных файлов `*.sha`, даже если они находятся во вложенных каталогах
- Обработка повторяющихся SHA (разные версии, разные каталоги)

## Анализ HTM
- Извлечение:
  - ID и класс элемента
  - Параметров (`parameters`)
  - Свойств (`hdxproperties`)
  - SRC-ссылок на формы
  - Типа связи (`linktype`)
- Определение общих параметров:
  - Заголовок мнемосхемы
  - Шаблон HMIWeb Template
  - Размеры и фон

## Анализ SHA
- Поддержка чтения кодировок: `windows-1252`, `windows-1251`, `utf-8`
- Разбор XML-структуры:
  - Title, Description
  - Width/Height
  - Список параметров
  - Список скриптов (ID, Language, Event, наличие кода)

## Excel-отчет
Создаются отдельные листы:
- General_Info - общая информация о мнемосхемах
- HMI_Tags - элементы с ItemProperty1
- Navigation_Shapes - все остальные элементы
- Shape_Definitions - полная структура SHА

Отчет:
- имеет статические и динамические заголовки  
- включает объединение данных с SHA-файлов  
- поддерживает мульти-строчное представление скриптов  

## Повышенная производительность
- Используется многопоточный разбор SHA (`ThreadPoolExecutor`)
- Поддержка lxml для ускоренного парсинга
- Кэширование результатов
