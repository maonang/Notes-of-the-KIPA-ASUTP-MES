# Объединить xlsx в один файл  
  
## Описание  
Предназначен для автоматического объединения данных из всех файлов .xlsx в текущей директории в один файл output.xlsx, сохраняя при этом порядок столбцов и форматирование ячеек из эталонного файла.  
  
## Назначение  
- Cбор больших объемов однотипных данных, разбитых на множество файлов  
- _Применение в моем случае_: Объединение всех выгрузок моделей из объектной модели в один файл, когда на стороне frontend получить сразу один файл нельзя  
  
# Возможности  
- Находит все файлы .xlsx в той же директории, где запущен скрипт (кроме файла output.xlsx)  
- Использует первый найденный файл как эталон для определения:  
  - Имени листа  
  - Порядка и состава полей таблицы  
- Копирует форматирование (шрифт, границы, формат чисел, цвет заливки) со второй строки эталонного файла и применяет его ко всем строкам объединенного результата  
- Обрабатывает только те файлы, которые имеют идентичный порядок и состав столбцов с эталонным файлом. Несоответствующие файлы пропускаются с предупреждением в логе  
- Ведет подробный лог процесса в файле log.log с временными метками  
- Выводит прогресс вставки данных в консоль для больших объемов  
  
# Принцип работы  
- Очищается log.log и ищутся все .xlsx файлы  
- Берется первый файл для определения имени листа и списка заголовков столбцов  
- Данные из эталонного файла и всех последующих, имеющих идентичный набор и порядок столбцов, считываются в DataFrame и объединяются  
- Эталонный файл загружается с помощью openpyxl, и стили всех ячеек второй строки копируются в словарь CELL_STYLES  
- Данные построчно записываются в новый лист output.xlsx. При записи к каждой ячейке применяется соответствующий скопированный стиль из CELL_STYLES. Если стили не были скопированы (например, во втором файле нет второй строки), применяются стандартные тонкие границы  
- Итоговый файл output.xlsx сохраняется  

