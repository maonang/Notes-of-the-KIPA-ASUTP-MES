# Выделение всех фигур с текстом на активной странице

```vba
Option Explicit

Public Sub SelectAllTextShapes()
    On Error Resume Next
    
    ActiveWindow.DeselectAll
    
    Dim shp As Visio.Shape
    Dim textShapesCount As Long
    
    For Each shp In ActivePage.Shapes
        ' Простая проверка: есть ли текст и не пустой ли он
        If shp.Text <> "" And Trim(shp.Text) <> "" Then
            ActiveWindow.Select shp, visSelect
            textShapesCount = textShapesCount + 1
        End If
    Next shp
    
    Select Case textShapesCount
        Case 0
            MsgBox "Фигуры с текстом не найдены.", vbInformation
        Case 1
            MsgBox "Выделена 1 фигура с текстом.", vbInformation
        Case Else
            MsgBox "Выделено фигур с текстом: " & textShapesCount, vbInformation
    End Select
    
    Exit Sub

ErrorHandler:
    MsgBox "Произошла ошибка: " & Err.Description & vbCrLf & _
           "Код ошибки: " & Err.Number, vbCritical, "Ошибка выполнения"
End Sub
```

## Описание
Макрос предназначен для автоматического выделения всех фигур с непустым текстом на активной странице документа Visio. Упрощает работу с диаграммами, содержащими большое количество элементов.

## Назначение
- Быстро найти все фигуры, содержащие текст.
- Автоматически выделить только те объекты, которые имеют непустые текстовые поля.
- Упростить редактирование и массовые операции над текстовыми элементами схемы.

# Возможности
- Просматривает все фигуры на активной странице.
- Определяет наличие текста с простой проверкой на пустые строки.
- Автоматически выделяет найденные фигуры.
- Выводит информационные сообщения о количестве найденных объектов.
- Обрабатывает исключения и сообщает об ошибках.

# Принцип работы
1. Макрос снимает текущее выделение на странице.
2. Последовательно перебирает все фигуры (`ActivePage.Shapes`).
3. Проверяет, содержит ли фигура текст и не является ли он пустым после `Trim`.
4. Все подходящие фигуры добавляются в текущее выделение.
5. После завершения перебора отображается сообщение о количестве найденных текстовых фигур.
6. В случае ошибки выводится окно с описанием и кодом ошибки.
