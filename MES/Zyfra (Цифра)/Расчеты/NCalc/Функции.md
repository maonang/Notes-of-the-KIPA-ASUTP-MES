# Встроенные функции NCalc
_Источник: https://ncalc.github.io/ncalc/articles/functions.html_

| Наименование | Описание | Применение | Результат |  
| --- | --- | --- | --- |
| Abs | Возвращает абсолютное значение указанного числа. | Abs(-1) | 1d |  
| Acos | Возвращает угол, косинус которого равен указанному числу. | Acos(1) | 0d |  
| Asin | Возвращает угол, синус которого равен указанному числу. | Asin(0) | 0d |  
| Atan | Возвращает угол, тангенс которого равен указанному числу. | Atan(0) | 0d |  
| Ceiling | Возвращает наименьшее целое число, большее или равное указанному числу. | Ceiling(1.5) | 2d |  
| Cos | Возвращает косинус указанного угла. | Cos(0) | 1d |  
| Exp | Возвращает значение e, возведенное в указанную степень. | Exp(0) | 1d |  
| Floor | Возвращает наибольшее целое число, меньшее или равное указанному числу. | Floor(1.5) | 1d |  
| IEEERemainder | Возвращает остаток, полученный в результате деления указанного числа на другое указанное число. | IEEERemainder(3, 2) | -1d |  
| Ln | Возвращает натуральный логарифм указанного числа. | Ln(1) | 0d |  
| Log | Возвращает логарифм указанного числа. | Log(1, 10) | 0d |  
| Log10 | Возвращает логарифм указанного числа по основанию 10. | Log10(1) | 0d |  
| Max | Возвращает большее из двух указанных чисел. | Max(1, 2) | 2 |  
| Min | Возвращает меньшее из двух чисел. | Min(1, 2) | 1 |  
| Pow | Возвращает указанное число, возведенное в указанную степень | Pow(3, 2) | 9d |  
| Round | Округляет значение до ближайшего целого числа или указанного количества знаков после запятой. Поведение среднего числа может быть изменено с помощью ExpressionOptions. Округление от нуля при построении объекта Expression. | Round(3.222, 2) | 3.22d |  
| Sign | Возвращает значение, указывающее знак числа. | Sign(-10) | -1 |  
| Sin | Возвращает синус указанного угла. | Sin(0) | 0d |  
| Sqrt | Возвращает квадратный корень из заданного числа. | Sqrt(4) | 2d |  
| Tan | Возвращает тангенс указанного угла. | Tan(0) | 0d |  
| Truncate | Вычисляет целую часть числа. | Truncate(1.7) | 1 |  
| | | | |  
| in | Возвращает, входит ли элемент в набор значений. | in(1 + 1, 1, 2, 3) | true |  
| if | Возвращает значение, основанное на условии. | if(3 % 2 = 1, 'value is true', 'value is false') | 'value is true' |  
| ifs | Возвращает значение, основанное на оценке ряда условий, и возвращает значение по умолчанию, если ни одно из них не является истинным. | ifs(foo > 50, "bar", foo > 75, "baz", "quux") | if foo is between 50 and 75 "bar", foo greater than 75 "baz", otherwise "quux" |  

В качестве разделителя аргументов можно использовать запятую (,) или точку с запятой (;).  
Если используется [DecimalAsDefault](https://ncalc.github.io/ncalc/api/NCalc.ExpressionOptions.html#NCalc_ExpressionOptions_DecimalAsDefault), то все функции будут приводить аргументы к [десятичному значению](https://learn.microsoft.com/ru-ru/dotnet/api/system.decimal?view=net-9.0).  

# Пользовательские функции
Пользовательские функции создаются с использованием делегата [ExpressionFunction](https://ncalc.github.io/ncalc/api/NCalc.ExpressionFunction.html).  
Параметры - это экземпляры [выражений](https://ncalc.github.io/ncalc/api/NCalc.Expression.html), которые могут быть обработаны с задержкой.  
```csharp
expression.Functions["SecretOperation"] = (args) => {
  return (int)args[0].Evaluate() + (int)args[1].Evaluate();
};
```

# Использование обработчиков событий
Вы также можете использовать обработчики событий для обработки функций.  
```csharp
expression.EvaluateFunction += delegate(string name, FunctionArgs args)
{
    if (name == "SecretOperation")
        args.Result = (int)args.Parameters[0].Evaluate() + (int)args.Parameters[1].Evaluate();
};
```
# Чувствительность к регистру
## Функции и параметры
По умолчанию процесс вычисления чувствителен к регистру. Это означает, что при вычислении каждого параметра и функции будет учитываться регистр. Это поведение можно переопределить как при использовании реализации IDictionary, так и при использовании пользовательского StringComparer.  
## Функция без учета регистра
```csharp
var expression = new Expression("secretOperation()")
{
    Functions = new Dictionary<string, ExpressionFunction>(StringComparer.InvariantCultureIgnoreCase)
    {
        { "SecretOperation", (arguments) => 42 }
    }
};

```
## Параметр без учета регистра
```csharp
var expression = new Expression("name == 'Beatriz'")
{
    Parameters = new Dictionary<string, object>(StringComparer.InvariantCultureIgnoreCase)
    {
        { "Name", "Beatriz" }
    }
};

```
## Встроенная функция, не чувствительная к регистру
```csharp
var expression = new Expression("aBs(-1)", ExpressionOptions.IgnoreCaseAtBuiltInFunctions);
```

## Сравнение строк
Вы также можете изменить сравнение строковых значений с помощью [CaseInsensitiveStringComparer](https://ncalc.github.io/ncalc/api/NCalc.ExpressionOptions.html#NCalc_ExpressionOptions_CaseInsensitiveStringComparer).
```csharp
var expression = new Expression("{PageState} == 'list'");
expression.Parameters["PageState"] = "List";
Debug.Assert(false, expression.Evaluate());
 
expression = new Expression("{PageState} == 'list'", ExpressionOptions.CaseInsensitiveStringComparer);
expression.Parameters["PageState"] = "List";
Debug.Assert(true, expression.Evaluate());
```
