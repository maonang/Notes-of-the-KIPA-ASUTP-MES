# _VBA Функция_: Извлечение Подстроки ( f_Substring() )

```vba
Function f_Substring(s_str As String, i_start As Long, i_stop As Long) As String
    If i_start < 0 Or _
        i_stop <= 0 Or _
        i_start > Len(s_str) Or _
        i_start > i_stop Then
        f_Substring = ""
    Else
        f_Substring = Mid(s_str, i_start, i_stop - i_start + 1)
    End If
End Function
```

## Описание  
Позволяет безопасно извлекать подстроку, задавая начальную и конечную позиции символов. Представляет собой улучшенную альтернативу встроенной функции ПСТР()/Mid() при работе с диапазонами позиций.
Функция включает проверку ошибок для предотвращения сбоев и возвращает пустую строку ("") при некорректных входных параметрах.

## Синтаксис
```vba
Function f_Подстрока(s_str As String, i_start As Long, i_stop As Long) As String
```

**Параметры**:
| Параметр | Тип данных | Описание |
| --- | --- | --- |
| s_str | String | Исходная строка, из которой необходимо извлечь подстроку |
| i_start | Long | Позиция первого символа подстроки (отсчет начинается с 1) |
| i_stop | Long | Позиция последнего символа подстроки (включительно) |

**Результат**:
- Извлеченная подстрока, если входные параметры корректны
- Пустая строка (""), если параметры некорректны (например, i_start > i_stop, i_start < 1 или i_start превышает длину строки)

## Сравнение
| Метод | Формула Excel | Описание |
| --- | --- | --- |
| VBA-функция | =f_Substring(A1; 4; 8) | Простой вызов функции с тремя аргументами: Строка, Начальная позиция, Конечная позиция. Четко выражает намерение пользователя |
| Формула листа | =ПСТР(A1; 4; 8 - 4 + 1) | Требует ручного вычисления длины подстроки как (Конечная позиция - Начальная позиция + 1), что делает формулу громоздкой и менее интуитивной |
